/*
 * This file is part of the orkan/wp-base1 package.
 * Copyright (c) 2024 Orkan <orkans+wpbase1@gmail.com>
 */
window.orkbasex1=window.orkbasex1||{};orkbasex1.fn={getId(name){return'#'+orkbasex1.name2id[name]},getElement(name){return document.getElementById(orkbasex1.name2id[name]??null)},log(msg,type='log'){if('debug'===type&&!orkbasex1.debug){return}else{type='log'}
console[type](msg)},debug(msg){this.log(msg,'debug')},clearForm(form){form.reset();Array.from(form.elements).forEach((input)=>{if(input.disabled){return}
switch(input.type.toLowerCase()){case 'text':case 'password':case 'textarea':case 'hidden':input.value='';break;case 'radio':case 'checkbox':input.checked=!1;break;case 'select-one':case 'select-multi':input.selectedIndex=-1;break}})},async usleep(usec){return await new Promise((resolve,reject)=>setTimeout(()=>resolve(1),usec))},};window.orkbasex1=window.orkbasex1||{};orkbasex1.Ajax={async fetch(opts={},data={}){let json,status,url=orkbasex1.url;data.action=opts.action;data[orkbasex1.nonce.name]=orkbasex1.nonce.action;opts={...{method:'POST',signal:null,Spinner:null,spinCls:null,},...opts,};switch(opts.method){case 'GET':url+='?'+this.getHttpQuery(data);break;case 'POST':opts.body=this.getFormData(data);break}
this.showSpinner(!0,opts.Spinner,opts.spinCls);const Response=await fetch(url,opts).then((Response)=>{status=`[${Response.status}] ${Response.statusText}`;orkbasex1.fn.debug(Response);return Response.text()}).catch((E)=>{throw new Error(E)});this.showSpinner(!1,opts.Spinner,opts.spinCls);try{json=JSON.parse(Response)}catch(E){throw new Error(E)}
if(!json||!json.success){throw new Error(json.data||status)}
return json.data},getHttpQuery(obj){const Query=new URLSearchParams(obj);return Query.toString()},getFormData(obj){const Data=new FormData();for(const[name,value]of Object.entries(obj)){Data.append(name,value)}
return Data},showSpinner(show,Spinner,className=null){if(Spinner){className=className??'is-active';const ClassList=Spinner.classList;show?ClassList.add(className):ClassList.remove(className)}},}