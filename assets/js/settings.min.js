/*
 * This file is part of the orkan/wp-base1 package.
 * Copyright (c) 2024 Orkan <orkans+wpbase1@gmail.com>
 */
window.ork=window.ork||{};(function($){ork.Base={getId(name){return'#'+ork.name2id[name]},getElement(name){return document.getElementById(ork.name2id[name])},log(msg,type='log'){if('debug'===type&&!ork.debug){return}else{type='log'}
console[type](msg)},debug(msg){this.log(msg,'debug')},clearForm(form){form.reset();Array.from(form.elements).forEach(input=>{if(input.disabled){return}
switch(input.type.toLowerCase()){case 'text':case 'password':case 'textarea':case 'hidden':input.value='';break;case 'radio':case 'checkbox':input.checked=!1;break;case 'select-one':case 'select-multi':input.selectedIndex=-1;break}})},showSpinner(id,show=!0){$(id+'_spin').toggleClass('is-active',show)},async usleep(usec){return await new Promise((resolve,reject)=>setTimeout(()=>resolve(1),usec))},};ork.Ajax={async fetch(action,data={},opts={}){let json,status,url=ork.url;data.action=action;data[ork.nonce.name]=ork.nonce.action;opts={...{method:'POST',signal:null,spinner:'',},...opts};if(opts.method=='POST'){opts.body=this.getFormData(data)}else if(opts.method=='GET'){url+='?'+this.getHttpQuery(data)}
this.spinner(opts.spinner,!0);const Response=await fetch(url,opts).then(Response=>{status=`[${Response.status}] ${Response.statusText}`;ork.Base.debug(Response);return Response.text()}).catch(E=>{throw new Error(E)});this.spinner(opts.spinner,!1);try{json=JSON.parse(Response)}catch(E){throw new Error(E)}
if(!json||!json.success){throw new Error(json.data||status)}
return json.data},getHttpQuery(obj){const Query=new URLSearchParams(obj);return Query.toString()},getFormData(obj){const Data=new FormData();for(const[name,value]of Object.entries(obj)){Data.append(name,value)}
return Data},spinner(id,show=!0,className='is-active'){if(id){const ClassList=document.querySelector(id).classList;show?ClassList.add(className):ClassList.remove(className)}},}})(jQuery)